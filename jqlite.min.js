/*!
 * forked from GIT: https://github.com/shrekshrek/jqlite
 **/

!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.$=e()}(this,function(){"use strict";var t=Array,e=[],n=e.slice,r=e.indexOf,i=document,o=Object.prototype.hasOwnProperty,a=Object.assign,u=void 0,c=!1,s=!0,f=null,l=/^\s*<(\w+|!)[^>]*>/,h={tr:"tbody",tbody:"table",thead:"table",tfoot:"table",td:"tr",th:"tr","*":"div"},d=i.querySelector("head"),p="__jql_EventListenersMap",v={"column-count":1,columns:1,"font-weight":1,"line-height":1,opacity:1,"z-index":1,zoom:1};function m(t,e,n){var r=e.e,i=e.fn,o=e.ns,a=e.sel;return t&&(!r||t.e===r)&&(!o||(n?t.ns===o:0===t.ns.indexOf(o)))&&(!i||t.fn===i)&&(!a||t.sel===a)}function g(t){var e,n;if(t)if(C(t)){var r=t.indexOf(".");-1!==r?(e=t.slice(0,r).trim(),n=t.slice(r).trim()+"."):(e=t.trim(),n="")}else if(T(t))return a({},t);return{e:e,ns:n}}function y(t){return t instanceof Window}function b(t){return"object"==typeof t}function T(t){return!!t&&b(t)}function w(t){return T(t)&&!y(t)&&Object.getPrototypeOf(t)===Object.prototype}function L(t){return"function"==typeof t}function C(t){return"string"==typeof t}function x(t){return function(t){return"number"==typeof t}(t)&&isFinite(t)}function E(t){return"boolean"==typeof t}function M(e){return t.isArray(e)}function O(t){return t instanceof Element}function j(t){return O(t)||y(t)||function(t){return t instanceof Document}(t)}function N(t){return t instanceof NodeList}function A(t){return t instanceof HTMLCollection}function S(t,e){if(T(t))for(var n in t)if(!e||o.call(t,n))return c;return s}var D=window.$=function(t,e){var n;if(!t)return new H;if(q(t))return t;if(C(t))if("<"===(t=t.trim())[0]){var r=l.test(t)&&RegExp.$1;r in h||(r="*"),n=k(t,r).children}else n=R(e||i,t);else if(M(t)||N(t)||A(t))n=t;else if(T(t))n=[t];else if(L(t))return X(t);return new H(n)};function H(t){this.length=0,function t(e,n){for(var i,o=0,a=0,u=n?n.length:0;a<u;a++)M(i=n[a])||N(i)||A(i)||q(i)?t(e,i):-1===r.call(e,n)&&(o++,e[a]=n[a]);e.length+=o}(this,t)}function I(t,e,n){if(e&&(T(e)||L(e)))for(var r in e)o.call(e,r)&&(n&&(w(e[r])||M(e[r]))?(w(e[r])&&!w(t[r])&&(t[r]={}),M(e[r])&&!M(t[r])&&(t[r]=[]),I(t[r],e[r],n)):e[r]!==u&&(t[r]=e[r]))}function q(t){return t instanceof H}function R(t,e){return t.querySelectorAll(e)}function P(t,e,n){return function(t){if(M(t)||C(t))return s;if(!T(t))return c;var e=t.length;return 0===e||x(e)&&e>0&&e-1 in t}(t)?W(t,e,n):B(t,e,n)}function W(t,e,n){if(t)for(var r=0,i=t.length;r<i&&e.call(n||t[r],r,t[r])!==c;r++);return t}function B(t,e,n){if(T(t))for(var r in t)if(o.call(t,r)&&e.call(n||t[r],r,t[r])===c)return t;return t}function X(t){(i.attachEvent?"complete"===i.readyState:"loading"!==i.readyState)?t():i.addEventListener("DOMContentLoaded",t,c)}function F(){return i.implementation.createHTMLDocument("")}function k(t,e,n){T(e)&&(n=e,e="");var r=(n||F()).createElement(e||"div");return r.innerHTML=t,r}function U(t){if(T(t)){var e,n=[];for(var r in t)o.call(t,r)&&(e=t[r])!=f&&n.push(encodeURIComponent(r)+"="+encodeURIComponent(e));return n.join("&")}return t}function $(t,e,n,r,i){return T(t)?t:(L(e)&&(i=r,r=n,n=e,e=u),L(n)||(i=r,r=n,n=u),{url:t,data:e,type:i,success:n,dataType:r})}function _(t,e){var n=i.createElement("script");if(a(n,t),T(e))for(var r in e)o.call(e,r)&&n.setAttribute(r,e[r]);return d.appendChild(n),d.removeChild(n),n}function z(t,e){try{return t[e]=u,delete t[e]}catch(t){}}function J(t){return t?"":"&_="+Date.now()}function G(t,e){return(t=String(t).replace(/#[\s\S]*/,""))+(-1===t.indexOf("?")?"?":"&"===t[t.length-1]?"":"&")+e.replace(/^[?&]+/,"")}function V(){}function Z(t,e){return function(n){var r=t,i=e;t=e=u,r&&r(i,n)}}function K(t,e,n,r,i){var o=(t=$(t,e,n,r,i)).onerror,l=t.complete;if(o=L(o)?o:u,l=L(l)?l:u,!C(t.url))return(o||l)&&setTimeout(function(){var t=l,e=u,n="error:InvalidURL";o=l=u,t&&t(e,n)}),{abort:V};var h=t.dataType?t.dataType.toLowerCase():"text";if("jsonp"===h)return function(t){var e=t.jsonp||"callback",n=t.jsonpCallback||"jsonpCallback_"+Date.now(),r=t.success,i=t.onerror,o=t.complete;r=L(r)?r:u,i=L(i)?i:u,o=L(o)?o:u;var a=t.data||{};a[e]=n;var l,h,d=t.timeout;window[n]=function(t){h=t};var p,v=p={abort:function(){m&&m({type:"abort",isLocaleAbort:s})}},m=function(t){l&&clearTimeout(l),p&&(p.abort=V);var e,a=t.currentTarget,c=r,s=i,f=h,d=o,v=t.type;p=h=l=o=r=i=m=u,"timeout"===v&&t.isLocaleAbort||(a&&(a=a.onerror=a.onload=a.onabort=r),z(window,n),n=r),"load"!==v||f===u&&(v="parseError")?s&&s(e,v):(e=f,c&&c(e,v)),d&&d(e,v)};return d>0&&(l=setTimeout(function(){l&&(l=f,m&&m({type:"timeout"}))},d)),_({src:G(t.url,U(a)+J(t.cache!==c)),onload:m,onerror:m,onabort:m}),v}(t);var d=U(t.data||{}),p=t.body;p||(p=d,d="");var v,m=new XMLHttpRequest,g=t.type?t.type.toUpperCase():"GET",y="script"!==h&&t.async!==c;m.open(g,G(t.url,d,J(t.cache!==c)),y,t.username,t.password);var b=t.xhrFields;if(T(b))for(v in b)m[v]=b[v];var w=t.mimeType;w&&m.overrideMimeType&&m.overrideMimeType(w);var x={"Content-Type":t.contentType||"POST"===g&&"application/x-www-form-urlencoded; charset=UTF-8"||""};for(v in a(x,t.headers),t.crossDomain||x["X-Requested-With"]||(x["X-Requested-With"]="XMLHttpRequest"),x)m.setRequestHeader(v,x[v]);var E,M,O,j,N,A=t.loadstart,S=t.progress,D=t.loadend,H=t.success,I=0;H=L(H)?H:u,A=L(A)?A:u,S=L(S)?S:u,D=L(D)?D:u;var q,R,P=t.timeout,W=q={abort:function(){B&&B({type:"abort",isLocaleAbort:s})}},B=function(t){var e=t.type,n=m,r=h,i=H,a=o,c=l,s=M;if(R&&clearTimeout(R),j&&clearTimeout(j),q&&(q.abort=V),q=h=R=O=I=N=j=H=o=l=A=S=M=m=B=u,n){n.onload=n.onerror=n.onabort=n.onloadstart=n.onprogress=n.ontimeout=n.onreadystatechange=u;var f=n.status,d=n.responseType;(t.isLocalAbort||t.isLocaleTimeout)&&n.abort&&n.abort();var p;if(e="load"===e?f>=200&&f<400?e:"error":e,s&&s(n,e),!i&&!a&&!c&&"script"!==r)return;if("load"===e){if("arraybuffer"===d||"blob"===d)p=n.response;else if("xml"===r)p=n.responseXML;else switch(p=n.responseText,r){case"json":p=JSON.parse(p);break;case"script":_({text:p})}i&&i(p,e,n)}else a&&a(p,e,n);c&&c(p,e,n)}};return A&&(m.onloadstart!==u?m.onloadstart=A:E=function(){m&&A&&A({currentTarget:m,target:m,type:"loadstart",isLocaleLoadstart:s})}),S&&(m.onprogress!==u?m.onprogress=S:(N=Math.min(Math.max((0|P)/100,100),100),O=function(){O&&S&&m&&++I<99&&(j=setTimeout(O,N),S({currentTarget:m,progress:I,target:m,type:"progress",isLocaleProgress:s}))})),m.onload=m.onerror=B,m.onabort!==u?m.onabort=B:m.onreadystatechange=function(){B&&m&&4===m.readyState&&setTimeout(function(){B&&B({type:"abort"})})},D&&(m.onloadend!==u?m.onloadend=function(t){var e=D;t.currentTarget.onloadend=u,e(t)}:M=function(t,e){setTimeout(function(){var n=D,r=t,i=e;D=t=e=u,n({type:"loadend",currentTarget:r,target:r,originalType:i,isLocaleLoadend:s})})}),P>0&&(m.timeout=P,m.ontimeout!==u?m.ontimeout=B:y&&(R=setTimeout(function(){R&&(R=f,B&&B({type:"timeout",isLocaleTimeout:s}))},P))),E&&E(),O&&(j=setTimeout(O,N)),m.send(p),W}function Q(t,e,n){for(var r in n)o.call(n,r)&&t[e](r,n[r])}function Y(t,e){return e?L(e)?e(t):O(t)&&(C(e)?e.trim():e)?t.matches(e):c:s}function tt(t,e,n){t.removeEventListener(e,n)}function et(t){var e=t.currentTarget,n=t.target,r=e[p],i=t.type,o=t.namespace||"",a={e:i,ns:o},u=r[i];W(u.concat(),function(o,f){if(m(f,a)&&function(t,e,n){for(var r=!n;!r&&O(e)&&e!==t;)e.matches(n)&&(r=s),e=e.parentNode;return r}(e,n,f.sel))return f.once&&nt(u,r,f,a,e,i),l=f.fn.call(e,t),h=t,l===c&&(h.cancelable&&h.preventDefault(),h.returnValue=c,h.stopPropagation(),h.stopImmediatePropagation()),l;var l,h}),rt(e,r)}function nt(t,e,n,r,i,o){t.splice(t.indexOf(n),1),t.length||(z(e,o),tt(i,o,et))}function rt(t,e){S(e,s)&&z(t,p)}return a(D,{is$:q,query:R,extend:function(t){var e,r=n.call(arguments,1);if(E(t)&&(e=t,t=r.shift()),t&&(T(t)||L(t)))for(var i=0,o=r.length;i<o;i++)I(t,r[i],e);return t},isObjectT:b,isObject:T,isPlainObject:w,isEmptyObject:S,isEmpty:function(t){return!t||T(t)&&S(t,s)},isFunction:L,isString:C,isNumber:x,isBoolean:E,isArray:M,isDate:function(t){return t instanceof Date},isRegExp:function(t){return t instanceof RegExp},isWindow:y,isCurrentWindow:function(t){return t===window},isElement:O,isNode:function(t){return t instanceof Node},isEleWinDoc:j,isNodeList:N,isHTMLCollection:A,parseHTML:function(t,e,r){if(!C(t))return[];if(E(e)&&(r=e,e=c),t=k(t,e),!r)for(var i=t.getElementsByTagName("script"),o=0,a=i.length;o<a;o++){var u=i[o];u.parentNode.removeChild(u)}return n.call(t.childNodes)},parseXML:function(t,e){var n;if(t&&C(t)){try{n=(new DOMParser).parseFromString(t,e||"application/xml")}catch(t){console.error(t)}n&&!n.getElementsByTagName("parsererror").length||(n=f,console.error("Invalid XML: ",t))}return n},newDocument:F,createTempElement:function(t,e){return(e||F()).createElement(t)},innerHTMLToTemp:k,newXMLDocument:function(t,e,n){return i.implementation.createDocument(t,e,n)},createDocFragment:function(t){var e=i.createDocumentFragment();return t&&(e=D(e).append(t)[0]),e},contains:function(t,e){return t!==e&&t.contains(e)},each:P,eachI:W,eachIn:B}),a(D,{get:function(t,e,n,r){return K(t,e,n,r)},post:function(t,e,n,r){return K(t,e,n,r,"POST")},getJSON:function(t,e,n){return $().dataType="json",K(t,e,n,"json")},loadImage:function t(e,n){if(n=L(n)?n:c,M(e)){var r=e.length,i=[];if(!r)return n&&n(),i;for(var o=[],a=s,l=n&&function(t,e){if(o[t]=e,a=a&&e!==u,--r<=0){var i=n;l=n=u,o[o.length]=a,i.apply(f,o)}},h=0;h<r;h++)i[h]=t(e[h],l&&Z(l,h));return i}var d=new Image;return n&&(d.onload=d.onerror=d.onabort=function(t){var e=n;this.onload=this.onerror=this.onabort=n=u,"load"===t.type?e(this):e()}),d.src=e,d},tryDelete:z,runScript:_,ajax:K,replace:function(t){L(t)&&(K=t)}}),a(H.prototype,D.fn={ready:X,get:function(t){return t===u?this:this[t]},eq:function(t){return D(-1===t?n.call(this,t):this[t])},first:function(){return this.length?this.eq(0):f},last:function(){return this.length?this.eq(this.length-1):f},filter:function(t){for(var e,n=new H,r=0,i=this.length;r<i;r++)(e=this[r])&&Y(e,t)&&(n[n.length++]=e);return n},find:function(t){if(t){var e=new H;return this.each(function(n,r){e.add(D(t,r))}),e}return this},add:function(t,e){for(var n,i=D(t,e),o=0,a=i.length;o<a;o++)-1===r.call(this,n=i[o])&&(this[this.length++]=n);return this},each:function(t){return P(this,t),this},empty:function(){return this.each(function(t,e){e.innerHTML=""})},parent:function(){var t=new H;return this.each(function(e,n){t.add(n.parentNode)}),t},children:function(){var t=new H;return this.each(function(e,n){t.add(n.children)}),t},clone:function(){var t=new H;return this.each(function(e,n){t.add(n.cloneNode(s))}),t},detach:function(t){return(t?this.filter(t):this).each(function(t,e){var n=e.parentNode;n&&n.removeChild&&n.removeChild(e)})},remove:function(t){return(t?this.filter(t):this).offAll().detach()},html:function(t){return arguments.length?this.each(function(e,n){n.innerHTML=t}):(t=this[0])?t.innerHTML:f},text:function(t){return arguments.length?this.each(function(e,n){n.textContent=t}):(t=this[0])?t.textContent:f},val:function(t){if(t===u){var e=this[0];return"select"===e.nodeName?e.options[e.selectedIndex].value:e.value||e.getAttribute("value")}return this.each(function(e,n){if("select"===n.nodeName){for(var r=0,i=n.options.length;r<i;r++)if(n.options[r].value===t){n.options[r].selected=s;break}}else n.value!==u?n.value=t:n.setAttribute("value",t)}),this},data:function(t,e){if(e!==u)this.each(function(n,r){r.dataset[t]=e});else if(T(t))Q(this,"data",t);else if(e=this[0])return e.dataset[t];return this},attr:function(t,e){if(e!==u)this.each(function(n,r){r.setAttribute(t,e)});else if(T(t))Q(this,"attr",t);else if(e=this[0])return e.getAttribute(t);return this},prop:function(t,e){if(e!==u)this.each(function(n,r){r[t]=e});else if(T(t))Q(this,"prop",t);else if(e=this[0])return e[t];return this},css:function(t,e){if(e!==u)e=L(e)?e():function(t,e){return x(e)&&!v[(n=t,n.replace(/([A-Z])/g,"-$1").toLowerCase())]?e+"px":e;var n}(t,e),this.each(function(n,r){r.style[t]=e});else if(T(t))Q(this,"css",t);else if(e=this[0])return e.style[t]||window.getComputedStyle(e)[t];return this},width:function(t){if(!this.length)return f;var e=this[0];if(y(e))return e.innerWidth;if(t){var n=window.getComputedStyle(e);return parseInt(n.marginLeft)+parseInt(n.marginRight)+e.offsetWidth}return e.offsetWidth},height:function(t){if(!this.length)return f;var e=this[0];if(y(e))return e.innerHeight;if(t){var n=window.getComputedStyle(e);return(t?parseInt(n.marginTop)+parseInt(n.marginBottom):0)+e.offsetHeight}return e.offsetHeight},show:function(){this.css("display","block")},hide:function(){this.css("display","none")},toggle:function(){return this.each(function(t,e){"none"===D(e).css("display")?e.show():e.hide()})},index:function(t){return t?r.call(this,D(t)[0]):r.call(this.parent().children(),this[0])},hasClass:function(t){var e=c;return this.each(function(n,r){r.classList.contains(t)&&(e=s)}),e},addClass:function(t){return this.each(function(e,n){n.classList.add(t)})},removeClass:function(t){return this.each(function(e,n){n.classList.remove(t)})},toggleClass:function(t){return this.each(function(e,n){n.classList.toggle(t)})},append:function(t){var e=D(t);return this.each(function(t,n){t>0&&(e=e.clone()),e.each(function(t,e){n.appendChild(e)})})},appendTo:function(t){return D(t).append(this),this},prepend:function(t){var e=D(t);return this.each(function(t,n){t>0&&(e=e.clone()),e.each(function(t,e){n.insertBefore(e,n.firstChild)})})},prependTo:function(t){return D(t).prepend(this),this},before:function(t){var e=D(t);return this.each(function(t,n){t>0&&(e=e.clone()),e.each(function(t,e){n.parentNode.insertBefore(e,n.parentNode.firstChild)})})},insertBefore:function(t){return D(t).before(this),this},after:function(t){var e=D(t);return this.each(function(t,n){t>0&&(e=e.clone()),e.each(function(t,e){n.parentNode.insertBefore(e,n.nextSibling)})})},insertAfter:function(t){return D(t).after(this),this},replaceWith:function(t){return this.before(t).remove()},on:function(t,e,n,r){if(!this.length)return this;var i,o,a=(t=g(t)).e;if(a&&(L(e)?(i="",L(n)||(o=e,r=n)):(i=C(e)?e.trim():"",o=n)),!L(o))return this;var u,f=c;return T(r)?(u=!!r.once,f={capture:c,passive:r.passive}):u=r===s,t.fn=o,t.sel=i,t.once=u,this.each(function(e,n){if(j(n)){var r,i=n[p]||(n[p]={});(i[a]||(r=s)&&(i[a]=[])).push(t),r&&function(t,e,n,r){t.addEventListener(e,n,r)}(n,a,et,f)}})},off:function(t,e,n){var r,i;if(!this.length)return this;L(e)?i=e:(r=e,i=n);var o=g(t),a=o.e,u=o.ns,c=!e,f=L(i),l=a&&c&&f;return a||u||!c||f?""===a?this.offAll(u,r,n):(o.fn=i,o.sel=r,this.each(function(t,e){j(e)&&(!function(t,e,n){var r=t[p];if(r){var i=r[e];i&&i.concat().forEach(function(o){m(o,n,s)&&nt(i,r,o,n,t,e)}),rt(r)}}(e,a,o),l&&tt(e,a,i))})):this},offAll:function(t,e,n){return L(t)?(n=t,t=""):L(e)&&(n=e,e=""),t=C(t)?t:"",this.each(function(r,i){if(j(i)){var o=i[p];if(T(o))for(var a in o)o.hasOwnProperty(a)&&D(i).off(a+t,e,n)}})},trigger:function(t,e){if(!this.length)return this;var n=(t=g(t)).e,r=t.ns;return this.each(function(t,o){if(j(o)){var a=i.createEvent("HTMLEvents");a.data=e,a.namespace=r,a.initEvent(n,s,s),o.dispatchEvent(a)}})}}),D});
